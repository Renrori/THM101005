@{
    ViewData["HideFooter"] = true;
}

<aside b-y5hjwqsk06 id="sidebar" class="sidebar">

    <ul b-y5hjwqsk06 class="sidebar-nav" id="sidebar-nav">

        <li b-y5hjwqsk06 class="nav-item">
            <a class="nav-link" href="#"><i b-y5hjwqsk06 class="bi bi-grid"></i>Home</a>
        </li>
        <li b-y5hjwqsk06 class="nav-item">
            <a class="nav-link collapsed" asp-controller="User" asp-action="UserHome"><i b-y5hjwqsk06 class="fa-solid fa-store"></i>我的資料</a>
        </li>
        <li b-y5hjwqsk06 class="nav-item">
            <a class="nav-link collapsed" asp-controller="User" asp-action="UserAddress"><i b-y5hjwqsk06 class="fa-solid fa-store"></i>我的地址</a>
        </li>
        <li b-y5hjwqsk06 class="nav-item">
            <a class="nav-link collapsed" asp-controller="User" asp-action="UserOrder"><i b-y5hjwqsk06 class="fa-solid fa-store"></i>我的訂單</a>
        </li>
        <li b-y5hjwqsk06 class="nav-item">
            <a class="nav-link collapsed" asp-controller="User" asp-action="UserOrderHistory"><i b-y5hjwqsk06 class="fa-solid fa-store"></i>歷史訂單</a>
        </li>
        <li b-y5hjwqsk06 class="nav-item">
            <a class="nav-link collapsed" href="#"><i b-y5hjwqsk06 class="fa-solid fa-circle-info"></i>Support</a>
        </li>
    </ul>

</aside><!-- End Sidebar-->
<template>
    <div>
        <select v-model="selectedCity">
            <option value="">請選擇縣市</option>
            <option v-for="city in addressData" :key="city.id" :value="city.name">{{ city.name }}</option>
        </select>

        <select v-model="selectedDistrict" v-if="selectedCity">
            <option value="">請選擇區域</option>
            <option v-for="district in selectedCityDistricts" :key="district.id" :value="district.name">{{ district.name }}</option>
        </select>
    </div>
</template>

@section scripts
    {
    <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
    <script src="https://unpkg.com/vue@3.2.36/dist/vue.global.prod.js"></script>
    <script src="~/axios/axios.min.js"></script>
    <script>
        var baseAddress = "https://localhost:7163/api/UserApi";
        var CustomerId = "@User.Claims.FirstOrDefault(c => c.Type == "CustomerId")?.Value";
        var vueApp = {
            data() {
                return {
                    CityCountryInfo: [],
                    searchResult: null,
                    searchorderId: "",
                }
            },
            mounted() {
                this.getUserOrder();
            },
            methods: {
                async getUserOrder() {
                    //拿出對應cusId的order
                    try {
                        const response = await axios.get(`${baseAddress}/waitorder/${CustomerId}`).then(Response => {
                            this.CustomerOrderInfo = Response.data;
                        })
                    } catch (error) {
                        console.error(error);
                    }
                },
                searchOrder(searchorderId) {
                    const foundOrder = this.CustomerOrderInfo.find(order => order.orderId === searchorderId)
                    if (foundOrder) {
                        this.searchResult = foundOrder;
                        console.log("match")
                    }
                    else {
                        this.searchResult = null;
                        console.log("notmatch")
                    }
                }
            }
        };
        var app = Vue.createApp(vueApp).mount("#app");
    </script>

}